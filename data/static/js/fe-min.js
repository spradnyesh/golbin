$(document).ready(function (event) { var subnav = null; var carouselMove = 4; var updateSubcategory = function (event) { if (event) { event.preventDefault(); }; var node = event.target.parentNode.parentNode; if (node.nodeName === "LI") { subnav = $("#subnav").children(); $("#subnav").empty(); return $("#subnav").append($(event.target.parentNode.parentNode).children("ul").children()); }; }; var restoreSubcategory = function (event) { if (event) { event.preventDefault(); }; var node = event.target.parentNode.parentNode; if (node.nodeName === "LI") { $(node).children("ul").append($("#subnav").children()); $("#subnav").empty(); return $("#subnav").append(subnav); }; }; var carouselPrev = function (event) { if (event) { event.preventDefault(); }; var parent = $(event.target.parentNode.parentNode); var prev = parent.children("div.prev"); var current = parent.children("div.current"); var next = parent.children("div.next"); var prevChildren = prev.children(); if (prevChildren.length > 0) { next.append(current.children()); return current.append(prev.children()[prevChildren.length - 1]); }; }; var carouselNext = function (event) { if (event) { event.preventDefault(); }; var parent = $(event.target.parentNode.parentNode); var prev = parent.children("div.prev"); var current = parent.children("div.current"); var next = parent.children("div.next"); var nextChildren = next.children(); var lenNext = nextChildren.length; if (lenNext > 0) { prev.append(current.children()); current.append(nextChildren[0]); if (lenNext === 1) { var id = parent.parent().children("span").html(); var pageTypeof = parent.children("span").html().split(", "); return $.ajax({ "url" : pageTypeof[1].replace(/0\\/$/, pageTypeof[0] + "/"), "cache" : false, "async" : false, "data-type" : "json" }).done(function (data) { if (data.status === "success") { parent.children("span").html(1 + parseInt(pageTypeof[0]) + ", " + pageTypeof[1]); return next.append(data.data); } else { return carouselFail(data); }; }).fail(function (data) { return carouselFail(data); }); }; }; }; var carouselFail = function (data) { return null; }; var ajaxifyComments = function () { return $("#comments").attr("action", "/ajax" + $("#comments").attr("action")); }; var commentSubmit = function (event) { $("#challenge td input").val(Recaptcha.get_challenge()); $("#response td input").val(Recaptcha.get_response()); return true; }; ajaxifyComments(); $("#prinav .cat h2 a").hover(function (event) { return updateSubcategory(event); }, function (event) { return restoreSubcategory(event); }); $(".carousel p.prev a").click(function (event) { return carouselPrev(event); }); $(".carousel p.next a").click(function (event) { return carouselNext(event); }); return $("#comments form").submit(function (event) { return commentSubmit(event); }); });
